<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><style type="text/css">/* Copyright 2019 Google LLC                              */
/*                                                        */
/* Use of this source code is governed by a BSD-style     */
/* license that can be found in the LICENSE file or at    */
/* https://developers.google.com/open-source/licenses/bsd */

body {
  font-family: Helvetica, sans-serif;
  font-size: 100%;
  color: #333;
  display: flex;
  justify-content: space-between;
  overflow-x: hidden;

  --main-width: 50rem;
  --nav-width: 20rem;
}

@media (max-width: 70rem) {
    /*For narrow screens hide nav and enable horizontal scrolling */
    nav {display: none;}
    body {overflow-x: auto;}
}

nav {/* this actually just holds space for #navbar, which is fixed */
  min-width: var(--nav-width);
  max-width: var(--nav-width);
}
#navbar {
  position: fixed;
  height: 100vh;
  width: var(--nav-width);
  overflow-y: scroll;
  border-right: 1px solid firebrick;
}
#navbar:before {
  content: "Contents";
  font-weight: bold;
}
nav ol {
  list-style-type:none;
  padding-left: 1rem;
}

#main-output {
  max-width: var(--main-width);
  margin: auto;
}

.cell {
}

.code-block, .err-block, .result-block {
  padding: 0em 0em 0em 2em;
  display: block;
  font-family: monospace;
  white-space: pre;
}

code {
  background-color: #F0F0F0;
}

.result-block {
  border-left: 3px solid  #87CEFA;
}

.prose-block {
  line-height: 140%;
}

.err-block {
  font-weight: bold;
  color: #B22222;
  border-left: 3px solid #B22222;
}

.plot {
  padding: 5em;
}

.plot-img {
  width: 80%;
}

.comment {
  color: #808080;
}

.keyword {
  color: #0000DD;
}

.command {
  color: #A80000;
}

.symbol {
  color: #E07000;
}

.type-name {
  color: #A80000;
}

.iso-sugar {
  color: #25BBA7;
}
</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="// Copyright 2019 Google LLC
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file or at
// https://developers.google.com/open-source/licenses/bsd

var katexOptions = {
    delimiters: [
        {left: &quot;$$&quot;, right: &quot;$$&quot;, display: true},
        {left: &quot;\\[&quot;, right: &quot;\\]&quot;, display: true},
        {left: &quot;$&quot;, right: &quot;$&quot;, display: false},
        {left: &quot;\\(&quot;, right: &quot;\\)&quot;, display: false}
    ],
    // Enable commands that load resources or change HTML attributes
    // (e.g. hyperlinks): https://katex.org/docs/security.html.
    trust: true
};

var cells = {};

function append_contents(key, contents) {
    if (key in cells) {
        var cur_cells = cells[key];
    } else {
        var cell = document.createElement(&quot;div&quot;);
        cell.className = &quot;cell&quot;;
        cells[key] = [cell];
        var cur_cells = [cell];
    }
    for (var i = 0; i &lt; contents.length; i++) {
        for (var j = 0; j &lt; cur_cells.length; j++) {
            var node = lookup_address(cur_cells[j], contents[i][0])
            node.innerHTML += contents[i][1];
        }
    }
}

function lookup_address(cell, address) {
    var node = cell
    for (i = 0; i &lt; address.length; i++) {
        node = node.children[address[i]]
    }
    return node
}

function renderLaTeX() {
    // Render LaTeX equations in prose blocks via KaTeX, if available.
    // Skip rendering if KaTeX is unavailable.
    if (typeof renderMathInElement == &#39;undefined&#39;) {
        return;
    }
    // Render LaTeX equations in prose blocks via KaTeX.
    var proseBlocks = document.querySelectorAll(&quot;.prose-block&quot;);
    Array.from(proseBlocks).map((proseBlock) =&gt;
        renderMathInElement(proseBlock, katexOptions)
    );
}

/**
 * Rendering the Table of Contents / Navigation Bar
 * 2 key functions
 *  - `updateNavigation()` which inserts/updates the navigation bar
 *  - and it&#39;s helper `extractStructure()` which extracts the structure of the page
 *    and adds ids to heading elements.
*/
function updateNavigation() {
    function navItemList(struct) {
        var listEle = document.createElement(&#39;ol&#39;)
        struct.children.forEach(childStruct=&gt;
            listEle.appendChild(navItem(childStruct))
        );
        return listEle;
    }
    function navItem(struct) {
        var a = document.createElement(&#39;a&#39;);
        a.appendChild(document.createTextNode(struct.text));
        a.title = struct.text;
        a.href = &quot;#&quot;+struct.id;

        var ele = document.createElement(&#39;li&#39;)
        ele.appendChild(a)
        ele.appendChild(navItemList(struct));
        return ele;
    }

    var navbarEle = document.getElementById(&quot;navbar&quot;)
    if (navbarEle === null) {  // create it
        navbarEle = document.createElement(&quot;div&quot;);
        navbarEle.id=&quot;navbar&quot;;
        navOuterEle = document.createElement(&quot;nav&quot;)
        navOuterEle.appendChild(navbarEle);
        document.body.prepend(navOuterEle);
    }

    navbarEle.innerHTML = &quot;&quot;
    var structure = extractStructure()
    navbarEle.appendChild(navItemList(structure));
}

function extractStructure() { // Also sets ids on h1,h2,...
    var headingsNodes = document.querySelectorAll(&quot;h1, h2, h3, h4, h5, h6&quot;);
    // For now we are just fulling going to regenerate the structure each time
    // Might be better if we made minimal changes, but ðŸ¤·

    // Extract the structure of the document
    var structure = {children:[]}
    var active = [structure.children];
    headingsNodes.forEach(
        function(currentValue, currentIndex) {
            currentValue.id = &quot;s-&quot; + currentIndex;
            var currentLevel = parseInt(currentValue.nodeName[1]);

            // Insert dummy levels up for any levels that are skipped
            for (var i=active.length; i &lt; currentLevel; i++) {
                var dummy = {id: &quot;&quot;, text: &quot;&quot;, children: []}
                active.push(dummy.children);
                var parentList = active[i-1]
                parentList.push(dummy);
            }
            // delete this level and everything after
            active.splice(currentLevel, active.length);

            var currentStructure = {
                id: currentValue.id,
                text: currentValue.textContent,
                children: [],
            };
            active.push(currentStructure.children);

            var parentList = active[active.length-2]
            parentList.push(currentStructure);
        },
    );
    return structure;
}

/**
 * HTML rendering mode.
 * Static rendering is used for static HTML pages.
 * Dynamic rendering is used for dynamic HTML pages via `dex web`.
 *
 * @enum {string}
 */
var RENDER_MODE = Object.freeze({
  STATIC: &quot;static&quot;,
  DYNAMIC: &quot;dynamic&quot;,
})

/**
 * Renders the webpage.
 * @param {RENDER_MODE} renderMode The render mode, either static or dynamic.
 */
function render(renderMode) {
    if (renderMode == RENDER_MODE.STATIC) {
        // For static pages, simply call rendering functions once.
        renderLaTeX();
        updateNavigation();
    } else {
        // For dynamic pages (via `dex web`), listen to update events.
        var source = new EventSource(&quot;/getnext&quot;);
        source.onmessage = function(event) {
            var body = document.getElementById(&quot;main-output&quot;);
            var msg = JSON.parse(event.data);
            if (msg == &quot;start&quot;) {
                body.innerHTML = &quot;&quot;;
                cells = {}
                return
            }
            var order    = msg[0];
            var contents = msg[1];
            for (var i = 0; i &lt; contents.length; i++) {
                append_contents(contents[i][0], contents[i][1]);
            }
            if (order != null) {
                var new_cells = {};
                body.innerHTML = &quot;&quot;;
                for (var i = 0; i &lt; order.val.length; i++) {
                    var key = order.val[i]
                    var cur_cells = cells[key]
                    if (cur_cells.length == 0) {
                        var cur_cell = new_cells[key][0].cloneNode(true)
                    } else {
                        var cur_cell = cur_cells.pop()
                        if (key in new_cells) {
                            new_cells[key].push(cur_cell);
                        } else {
                            new_cells[key] = [cur_cell];
                        }
                    }
                    body.appendChild(cur_cell);
                }
                Object.assign(cells, new_cells);
            }
            renderLaTeX();
            updateNavigation();
        };
    }
}
render(RENDER_MODE.STATIC);"></script></head><body><div id="main-output"><div class="cell"><div class="code-block"></div></div><div class="cell"><div class="prose-block"><h1>Fluid Simulation</h1>
<p>Fluid simulation code based on
<a href="https://www.josstam.com/publications">Real-Time Fluid Dynamics for Games</a> by Jos Stam</p>
</div></div><div class="cell"><div class="code-block"><span class="keyword">import</span> png
</div></div><div class="cell"><div class="code-block"><span class="keyword">import</span> plot
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> wrapidx (n<span class="symbol">:</span><span class="type-name">Type</span>) [<span class="type-name">Ix</span> n] (i<span class="symbol">:</span><span class="type-name">Int</span>) <span class="symbol">:</span> n <span class="symbol">=</span>
  <span class="comment">-- Index wrapping around at ends.
</span>  asidx <span class="symbol">$</span> unsafe_i_to_n <span class="symbol">$</span> mod i <span class="symbol">$</span> n_to_i <span class="symbol">$</span> size n
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> incwrap {n} [<span class="type-name">Ix</span> n] (i<span class="command">:n</span>) <span class="symbol">:</span> n <span class="symbol">=</span>  <span class="comment">-- Increment index, wrapping around at ends.
</span>  asidx <span class="symbol">$</span> unsafe_i_to_n <span class="symbol">$</span> mod ((n_to_i <span class="symbol">$</span> ordinal i) <span class="symbol">+</span> 1) <span class="symbol">$</span> n_to_i <span class="symbol">$</span> size n
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> decwrap {n} [<span class="type-name">Ix</span> n] (i<span class="command">:n</span>) <span class="symbol">:</span> n <span class="symbol">=</span>  <span class="comment">-- Decrement index, wrapping around at ends.
</span>  asidx <span class="symbol">$</span> unsafe_i_to_n <span class="symbol">$</span> mod (n_to_i (ordinal i) <span class="symbol">-</span> 1) <span class="symbol">$</span> n_to_i <span class="symbol">$</span> size n
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> finite_difference_neighbours {n a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>a) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>(incwrap i) <span class="symbol">-</span> x<span class="symbol">.</span>(decwrap i)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> add_neighbours {n a} [<span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>a) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>(incwrap i) <span class="symbol">+</span> x<span class="symbol">.</span>(decwrap i)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> apply_along_axis1 {b c a} (f<span class="command">:b</span><span class="symbol">=&gt;</span>a <span class="symbol">-&gt;</span> b<span class="symbol">=&gt;</span>a) (x<span class="command">:b</span><span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> b<span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  transpose <span class="keyword">for</span> j<span class="symbol">.</span> f <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i<span class="symbol">.</span>j
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> apply_along_axis2 {b c a} (f<span class="command">:c</span><span class="symbol">=&gt;</span>a <span class="symbol">-&gt;</span> c<span class="symbol">=&gt;</span>a) (x<span class="command">:b</span><span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> b<span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="keyword">for</span> i<span class="symbol">.</span> f x<span class="symbol">.</span>i
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> fdx {n m a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  apply_along_axis1 finite_difference_neighbours x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> fdy {n m a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  apply_along_axis2 finite_difference_neighbours x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> divergence {n m a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (vx<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) (vy<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  fdx vx <span class="symbol">+</span> fdy vy
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> add_neighbours_2d {n m a} [<span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  ax1 <span class="symbol">=</span> apply_along_axis1 add_neighbours x
  ax2 <span class="symbol">=</span> apply_along_axis2 add_neighbours x
  ax1 <span class="symbol">+</span> ax2
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> project_vel {n m a} [<span class="type-name">VSpace</span> a] (v<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="comment">-- Project_vel the velocity field to be approximately mass-conserving,
</span>  <span class="comment">-- using a few iterations of Gauss-Seidel.
</span>  h <span class="symbol">=</span> 1<span class="symbol">.</span>0 <span class="symbol">/</span> n_to_f (size n)

  <span class="comment">-- unpack into two scalar fields
</span>  vx <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 0)
  vy <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 1)

  div <span class="symbol">=</span> <span class="symbol">-</span>0<span class="symbol">.</span>5 <span class="symbol">.*</span> h <span class="symbol">.*</span> (divergence vx vy)

  p <span class="symbol">=</span> yield_state zero <span class="symbol">\</span>state<span class="symbol">.</span>
    <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 10)<span class="symbol">.</span>
      state <span class="symbol">:=</span> (1<span class="symbol">.</span>0 <span class="symbol">/</span> 4<span class="symbol">.</span>0) <span class="symbol">.*</span> (div <span class="symbol">+</span> add_neighbours_2d (get state))

  vx <span class="symbol">=</span> vx <span class="symbol">-</span> (0<span class="symbol">.</span>5 <span class="symbol">/</span> h) <span class="symbol">.*</span> fdx(p)
  vy <span class="symbol">=</span> vy <span class="symbol">-</span> (0<span class="symbol">.</span>5 <span class="symbol">/</span> h) <span class="symbol">.*</span> fdy(p)

  <span class="keyword">for</span> i j<span class="symbol">.</span> [vx<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">,</span> vy<span class="symbol">.</span>i<span class="symbol">.</span>j]  <span class="comment">-- pack back into a table.
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> bilinear_interp {a} [<span class="type-name">VSpace</span> a] (right_weight<span class="symbol">:</span><span class="type-name">Float</span>) (bottom_weight<span class="symbol">:</span><span class="type-name">Float</span>)
  (topleft<span class="symbol">:</span> a) (bottomleft<span class="symbol">:</span> a) (topright<span class="symbol">:</span> a) (bottomright<span class="symbol">:</span> a) <span class="symbol">:</span> a <span class="symbol">=</span>
  left  <span class="symbol">=</span> (1<span class="symbol">.</span>0 <span class="symbol">-</span> right_weight) <span class="symbol">.*</span> ((1<span class="symbol">.</span>0 <span class="symbol">-</span> bottom_weight) <span class="symbol">.*</span> topleft  <span class="symbol">+</span> bottom_weight <span class="symbol">.*</span> bottomleft)
  right <span class="symbol">=</span>        right_weight  <span class="symbol">.*</span> ((1<span class="symbol">.</span>0 <span class="symbol">-</span> bottom_weight) <span class="symbol">.*</span> topright <span class="symbol">+</span> bottom_weight <span class="symbol">.*</span> bottomright)
  left <span class="symbol">+</span> right
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> advect {n m a} [<span class="type-name">VSpace</span> a] (f<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) (v<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="comment">-- Move field f according to x and y velocities (u and v)
</span>  <span class="comment">-- using an implicit Euler integrator.
</span>
  cell_xs <span class="symbol">=</span> linspace n 0<span class="symbol">.</span>0 <span class="symbol">$</span> n_to_f (size n)
  cell_ys <span class="symbol">=</span> linspace m 0<span class="symbol">.</span>0 <span class="symbol">$</span> n_to_f (size m)

  <span class="keyword">for</span> i j<span class="symbol">.</span>
    <span class="comment">-- Location of source of flow for this cell.  No meshgrid!
</span>    center_xs <span class="symbol">=</span> cell_xs<span class="symbol">.</span>i <span class="symbol">-</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 0)
    center_ys <span class="symbol">=</span> cell_ys<span class="symbol">.</span>j <span class="symbol">-</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 1)

    <span class="comment">-- Index of source cell.
</span>    source_col <span class="symbol">=</span> floor center_xs
    source_row <span class="symbol">=</span> floor center_ys

    <span class="comment">-- Relative weight of right-hand and bottom cells.
</span>    right_weight  <span class="symbol">=</span> center_xs <span class="symbol">-</span> source_col
    bottom_weight <span class="symbol">=</span> center_ys <span class="symbol">-</span> source_row

    <span class="comment">-- Cast back to indices, wrapping around edges.
</span>    l <span class="symbol">=</span> wrapidx n  (f_to_i source_col)
    r <span class="symbol">=</span> wrapidx n ((f_to_i source_col) <span class="symbol">+</span> 1)
    t <span class="symbol">=</span> wrapidx m  (f_to_i source_row)
    b <span class="symbol">=</span> wrapidx m ((f_to_i source_row) <span class="symbol">+</span> 1)

    <span class="comment">-- A convex weighting of the 4 surrounding cells.
</span>    bilinear_interp right_weight bottom_weight f<span class="symbol">.</span>l<span class="symbol">.</span>t f<span class="symbol">.</span>l<span class="symbol">.</span>b f<span class="symbol">.</span>r<span class="symbol">.</span>t f<span class="symbol">.</span>r<span class="symbol">.</span>b
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> fluidsim {n m a} [<span class="type-name">VSpace</span> a] (num_steps<span class="symbol">:</span> <span class="type-name">Nat</span>) (color_init<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a)
  (v<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">:</span> (<span class="type-name">Fin</span> num_steps)<span class="symbol">=&gt;</span>n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  with_state (color_init<span class="symbol">,</span> v) <span class="symbol">\</span>state<span class="symbol">.</span>
    <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> num_steps)<span class="symbol">.</span>
      (color<span class="symbol">,</span> v) <span class="symbol">=</span> get state
      v <span class="symbol">=</span> advect v v          <span class="comment">-- Move velocities
</span>      v <span class="symbol">=</span> project_vel v       <span class="comment">-- Project to be volume-preserving
</span>      color&#39; <span class="symbol">=</span> advect color v <span class="comment">-- Move color
</span>      state <span class="symbol">:=</span> (color&#39;<span class="symbol">,</span> v)
      color
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h2>Demo</h2>
</div></div><div class="cell"><div class="code-block"><span class="type-name">N</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 50
</div></div><div class="cell"><div class="code-block"><span class="type-name">M</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 50
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Create random velocity field.
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> ixkey3 {n m o} [<span class="type-name">Ix</span> n<span class="symbol">,</span> <span class="type-name">Ix</span> m<span class="symbol">,</span> <span class="type-name">Ix</span> o] (k<span class="symbol">:</span><span class="type-name">Key</span>) (i<span class="command">:n</span>) (j<span class="command">:m</span>) (k2<span class="command">:o</span>) <span class="symbol">:</span> <span class="type-name">Key</span> <span class="symbol">=</span>
  hash (hash (hash k (ordinal i)) (ordinal j)) (ordinal k2)
</div></div><div class="cell"><div class="code-block">init_velocity <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">N</span> j<span class="symbol">:</span><span class="type-name">M</span> k<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span>
  3<span class="symbol">.</span>0 <span class="symbol">*</span> (randn <span class="symbol">$</span> ixkey3 (new_key 0) i j k)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Create diagonally-striped color pattern.
</span></div></div><div class="cell"><div class="code-block">init_color <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">N</span> j<span class="symbol">:</span><span class="type-name">M</span><span class="symbol">.</span>
  i&#39; <span class="symbol">=</span> n_to_f <span class="symbol">$</span> ordinal i
  j&#39; <span class="symbol">=</span> n_to_f <span class="symbol">$</span> ordinal j
  r <span class="symbol">=</span> b_to_f <span class="symbol">$</span> (sin <span class="symbol">$</span> (j&#39; <span class="symbol">+</span> i&#39;) <span class="symbol">/</span> 8<span class="symbol">.</span>0) <span class="symbol">&gt;</span> 0<span class="symbol">.</span>0
  b <span class="symbol">=</span> b_to_f <span class="symbol">$</span> (sin <span class="symbol">$</span> (j&#39; <span class="symbol">-</span> i&#39;) <span class="symbol">/</span> 6<span class="symbol">.</span>0) <span class="symbol">&gt;</span> 0<span class="symbol">.</span>0
  g <span class="symbol">=</span> b_to_f <span class="symbol">$</span> (sin <span class="symbol">$</span> (j&#39; <span class="symbol">+</span> i&#39;) <span class="symbol">/</span> 4<span class="symbol">.</span>0) <span class="symbol">&gt;</span> 0<span class="symbol">.</span>0
  [r<span class="symbol">,</span> g<span class="symbol">,</span> b]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Run fluid sim and plot it.
</span></div></div><div class="cell"><div class="code-block">num_steps <span class="symbol">=</span> 5
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> imseqshow <span class="symbol">$</span> fluidsim num_steps init_color init_velocity
</div><img class="plot-img" src="data:image/png;base64, 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"></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h3>Gradient test</h3>
</div></div><div class="cell"><div class="code-block">target <span class="symbol">=</span> transpose init_color
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- This is partial
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> last {n a} (xs<span class="command">:n</span><span class="symbol">=&gt;</span>a) <span class="symbol">:</span> a <span class="symbol">=</span> xs<span class="symbol">.</span>((unsafe_nat_diff (size n) 1)<span class="symbol">@</span>_)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> objective (v<span class="symbol">:</span><span class="type-name">N</span><span class="symbol">=&gt;</span><span class="type-name">M</span><span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">:</span> <span class="type-name">Float</span> <span class="symbol">=</span>
  final_color <span class="symbol">=</span> last <span class="symbol">$</span> fluidsim num_steps init_color v
  sum <span class="keyword">for</span> (i<span class="symbol">,</span> j<span class="symbol">,</span> c)<span class="symbol">.</span> sq (final_color<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>c <span class="symbol">-</span> target<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>c)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">init_vel_grad <span class="symbol">=</span> grad objective zero
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> imshow <span class="keyword">for</span> i j<span class="symbol">.</span> [0<span class="symbol">.</span>0<span class="symbol">,</span> init_vel_grad<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(0<span class="symbol">@</span>_)<span class="symbol">,</span> init_vel_grad<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(1<span class="symbol">@</span>_)]
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAAAAXNSR0IArs4c6QAAC+BJREFUWIW12XuQ3WV9x/HX8/v9ztlz3XtCEgK5oKGaCGgpJgEM13KrVrSoqEmIUVHHyrTaQZxKalGrtVNx7AShkMumXLQX7wVrlbGd0qnVVmzrTBFEzCRFl5DN3rK7Oec8/eOcX7KbDdY64Zmd2Tkzv8/5vs/3eb635wdi5HbPtb75tBitf8KCu6UfI8KaKOIdz6nCgwdMRy//sYEdko93hGe3hTfOffR0NvBuotsucU7M4CLiTXZc5S1nnujrr/DFjRaN2X/A8DAbuduhQBQJ28TF8ySByKt87nUWjNk37MDP2Mw9RnJh9hGNQdBFoJ9G2w0el1nF9t8WbhNXCY+KZ3uIBgnDFKiM++4/GI3iCAnjPGRvb8d2XCREPwh200+gRRa1ahaP+s63jU5pjoAxHvJUf0fYGBCiJ4P7B/TXVaNGRZEGXTIv5M5P2FsWDotnCY9orXcfLVrsJez1o5ZJGkXFcTNFJjgsLBeP+ix6JNhFLwnTmXTc3lE/edTBxJE2U8Yk48IL5gj/LdizUm9JccoEOCQzzXjJh9f6Xll4UlwnfN1jl/sLWhxmeMahJ413S44IFYbJYMGPhYvnGNgT7AzqUdYwVpI9bf8REy2NSMozpDD4uHDFHOEDwe63q2UyxmhKTLCP8dSfrPHwCuG74mVWfdllPM1BDnOIMKoxpXqAwCQcZMnDwqsJENkYXRX9MPUTxqb8KDH1M6OTWhOyEQKjFD3L4q8JbzwmfEN0yU7/VfM4z7AfL+Tc6NJXes0a11Z9Cd8UI3/ji1zLb3IxqzmDXroRFJHoYiFeLxKjGIk+wOLMSlYxWHQKpS6FgpBSAmWFgkG8Y47wvYv0Rks5I7KYF0RnX2/D+a6puIoH8GUx8ln3cTmXch5ncDr1NhllFBWCPrxpjoGbqGcWsoRyops0lQQBXVL0SOq6K/zeHOH1/wP1SIVTolU3WnOFCxZ2IIbwV2Lkfju4kAt5GctYSo0eQpusJMnU8OY5Bm6kmOphgAJVQv6nLEkZZFBxgD+cIzxXJ8NZFC19jxdfa/UZ1nMJG7gHD4iRe93FetZzDqfPItPelgoFZWycY2ArIVXNw7OSZ7QQqNLFYk5lKbfPEl7m3DaWaPktlr/e6lVeXLKWDVzAXbhXjOzxGdayjrM5nVOPkgVdOVlxHtkNSJTpIWl7t42WUKfCUpazgrsdags/R2Ty8349esWfedmbrVpjdcmLOI8LWc+d2NMhu4OXs5azZpEdi4AKBYV5ZJuRKM3e9/ZepnRT5dT8cPyBP0VHOO6u3d72NhdssGaZlVVnsopzOZ913IEhMTJk+yyy02aTJQo5WTaPbBOCEt2zyRJSahSpzildUWbfBiODJg9qHNAY15oyQRcjdFNiN3dsEogbBbZvsjs/KAfpYYR6y1gim9SoapDtETbOSZibgqFAVGeMUjTVPtqTFHSyO71cAZlvPOGn+x04ojVtalqjqUGDEiP0UP6/yHpnk010yNITkiW0OmTl6HAiROGIVqrUhAEmeUBmeMRPR7Ro5+HDndxrggojeYr6/5I1fy5ZN2NUW6YyWZSlstRgQ2/LIP8t8V4yRklptwhTNGgyQZMRJgnsZvsmYY+40buGbKad9vpI6KVFvaWRyCYoaBY6ZEeLzFC0qWUqMUM306laQ9qlVNBdVxu0ZLFlie6uTGAHD3KYjBEqTNFFZIIqh3KfDbXJfhGfTT6nzzYHuzOhobtpsqy7Sb9qWa1XbZHKXo++gbiapfrzKGhXrTpddNPHAKezgnNYx1q2/9zYrFJHIkOVgvSEWaNLLVgY9JzijNOsXut1V7jlnWLZJx3LE1bSpiuT5GH4/JHdQNKtp+bUQYvO87LrXL7NTVG8jJh5xyz3Xhp84xTTw6otk1SZpiuPgF9yN9sREKR7hE1zdnNLMLREUlBv2t9npuAx/vPv8417etaPeA0GFOmlQK9O6TgJPitKsWmOz95Cepa+CyzZqu+jFkYVealu4x/rLtCtTJ8O30kmu2GOuS2Eq9Xfrm+bJHZ48n8/mPPoRpQ7wX+Sydr91tZ51el3FX9fdjzWzTwy79GCCv0nl6xGWZpw49wt6uaPcqBjWB/j7eyZF8bpSSVLZTqNQ1LkPXPMvXr5UawsP/YJPcJO4RPzUl9CS41xKkxT/KVjs2kslY1q9Gplwg7h5lnmnnTxiIfpjFbQIhXr0p3CB+aRBeLJI8ukI5oDYoG7hdtmmeu1kh+1sQIxk01rZJpV2U7hpnlktA/GcWSTVH5hsh4OUWsYL0oOai0g4TPCp2aZu8aqNlak1jKeKo2ZyjTKsh3Cjc8X2Qi1GeNdPMsgKbcL9zgQ9EdxqyBx4EHns2KxZdNipnyQTKMs3Sm85Vjx3x1tZpIpakzSxQwtmkzS5FDeFw09d6+R5r1GdToftWdocKuBD/lEEK4VBXHap7/gXx7x6I89+5SfTUme6Vw0pKOam8VdnQAJOj6rUJrrs3YDXCHNO8fIJt41JG4U9nR81h7ID9LkYPtjoXMZYsrRFWWeutDYAlOj0hFxQmXUaCo5qFXRrEh2CZufl93sY4TqERPhGFMfl7cj8eHHDe830hAbWg2tlq4Z00VGqWqVJbuPL7EnkewQPbHzJS0GmeJ+mWeeNfwsjJHSyrSCdEKzxCh1rSgZOjFZ+MXITthtB0boZ5yFNBikmwX8UOZ9bGGcAs+QNUwHLcKkWGaMupbnJDvqsypT88jC/NkpuGOj3VRJGWWAGfqLqmVLMysOqBUygV08xAQJo3S1p6X2+SznPjsR2Q3BLlCf67NWTjaSl6zjJpTPbDRElYwJ6iS9BnrUT1ff5/vXE3+FJRbkUdD+uV2O3mNQJnS61cTxDdOWfCsHKdFPhV76GWQZK3gp61nbnoTbM/p97uJCLuEVrCu58jRbz/exN4mJ7e1wbBtYhQGCis7FQQg5W2ku2ebjW7kkPxZlBqjSdyKyde3bg/a9xufcw8VcyZUlV19k61vdGsXziIn35QnzseiqAyzUSPW0HElUY377056ExujSKst2C5uPZdod0VYOc4RupihzhJiPzS0OMUXKEH/+JuGz4nW2ftENtCgkwpS9Vd/ium/nG3d4bgMYBnQHC/LhJyXJ76U6A2FFl+ObzHdSZpAl1FlIPW+BFrCcF/BrbOAiduGvxcg33cfVda9a58rrnRudhZhAOR776Xuidx7QrGpvaYNafsaSw5Sl45TM1HQPCVuOCe+Ibsyd1McMZRr5jfUkkTGOUOR+Hnit8FXxYm/8ni1jNKUNVUbp3LRUCf96zMD26N3jYibJydqHPgbZlGZVeZKKVt2SoTl18/boXTTzfD1DF0doEvNyeTjPKX/JV35D+JZ4tut+auu3FSeUO87ODFKmdK/wjTnB/+HgLjL6GKbIDDFTOaLZbeG0Zk0hcdZuYcsc4UeCuzptpQOk+cuHrvzwtShS50v800XCv4vnCNHXgh1E1si8uN3NdVk5JNw5x8Cng9vJKDBOFiWZUDIQpYMWj2vWlbl61/H57NPBp0hJmaRIM9FKdAVpqn+qk0Rq/B1PvFTYJy4Ron/8W3e2W+s6L+FwXXXE+3dZdKunZxnYGWxjHDS6FFOlilLVwtRpPfr2a5alDe8d0nP9rBdBubBdghqJWkFaVyzoTS1tGHxanRpV/pl4qtAWXu07fFKm1L6inXCorFhwy91e8lb/cdTAAbcN+GAes81BaU1vXc+pVh+UzUj2mc40i26534pXe/KocNhtCzrCmDhyChXVitoplj2rt6kwrEyRQR5MxJCT8TWZ73N/O2HuI4Gb7ta6UtI20C98nJvpZlCzT7bYorply22b5LG8lCbw/i8YuVhvWziYC+sMmOqVLLKgYuky7xnlCbL8lRhaLBSDD0VxREDl614U+Qrv5kwW5Y8u9xq+GvOh7bVcww3Sbc76Y+XossileZsye610DZ8/KvwtrmGT4gf96kf1Rq+MrO+8/zm22sPOaohHz6nAACN5fLfXMp4idvKWe3lMqcetj/rAS8XfmQd0dK3iseOFlW7bvufmc8T3zXs+y+8nz+Q7gv8FKvezWenhuTIAAAAASUVORK5CYII="></div></div></body></html>